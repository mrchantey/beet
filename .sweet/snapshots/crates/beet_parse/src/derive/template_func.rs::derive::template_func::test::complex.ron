use beet::prelude::*;
/// probably the best templating layout ever
#[derive(Props)]
pub(crate) struct MyNode {
    /// some comment
    pub foo: u32,
    pub bar: u32,
}
impl MyNode {
    pub fn system(
        #[allow(unused_variables)]
        In((my_entity, input)): In<(Entity, Self)>,
        world: &mut World,
        res: Res<Time>,
        mut query: Query<&mut Transform>,
    ) -> impl Bundle + use<> {
        let Self { foo, mut bar } = input;
        ()
    }
}
impl IntoBundle<Self> for MyNode {
    fn into_bundle(self) -> impl Bundle {
        OnSpawn::new(move |entity_world_mut: &mut EntityWorldMut| {
            let id = entity_world_mut.id();
            let bundle = entity_world_mut
                .world_scope(|world| {
                    world
                        .run_system_cached_with(Self::system, (id, self))
                        .map_err(|err| {
                            bevyhow!(
                                "Error running template system for `MyNode`: {}", err
                            )
                        })
                        .unwrap_or_exit()
                });
            entity_world_mut.insert(bundle.into_bundle());
        })
    }
}

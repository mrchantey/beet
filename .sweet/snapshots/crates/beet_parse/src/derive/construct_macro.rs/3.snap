#[derive(Component, Clone)]
#[component(on_add = on_add_my_node)]
pub(crate) struct MyNode {
    pub foo: u32,
}
fn on_add_my_node(mut world: DeferredWorld, cx: HookContext) {
    let entity = cx.entity;
    world
        .commands()
        .queue(move |world: &mut World| {
            let mut entity_world_mut = world.entity_mut(entity);
            let id = entity_world_mut.id();
            let this = entity_world_mut.get::<MyNode>().unwrap().clone();
            let bundle: _ = {
                fn system(
                    #[allow(unused_variables, unused_assignments)]
                    In((entity, this)): In<(Entity, MyNode)>,
                    mut my_res: Res<Time>,
                ) -> impl Bundle + use<> {
                    #[allow(unused_variables, unused_assignments)]
                    let MyNode { foo } = this;
                    ()
                }
                entity_world_mut
                    .world_scope(|world| {
                        world
                            .run_system_cached_with(system, (id, this))
                            .map_err(|err| {
                                bevyhow!(
                                    "Error running template system for `MyNode`: {}", err
                                )
                            })
                            .unwrap_or_exit()
                    })
            };
            entity_world_mut.insert(bundle);
        });
}
